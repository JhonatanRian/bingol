class BingoCaller{textToSpeech=null;columnToLetter={0:'B',1:'I',2:'N',3:'G',4:'O'};words=[];wordsShowed=[];interval=null;defaultTimeout=3000;constructor(textToSpeech){this.textToSpeech=textToSpeech}
shuffleArray(array){let currentIndex=array.length,temporaryValue,randomIndex;while(0!==currentIndex){randomIndex=Math.floor(Math.random()*currentIndex);currentIndex-=1;temporaryValue=array[currentIndex];array[currentIndex]=array[randomIndex];array[randomIndex]=temporaryValue}
return array};createWordsQue(words){let newWords=[];for(let i=0;i<words.length;i++){for(let j=0;j<words[i].length;j++){newWords.push({column:this.columnToLetter[i],word:words[i][j]})}}
return this.shuffleArray(newWords)};splitTextIfLong(text){const LETTERS_COUNT_FOR_BR=9;const LETTERS_COUNT_FOR_SPAN=7;let newText=text;if(newText.length>LETTERS_COUNT_FOR_SPAN){newText='<span>'+newText.substring(0,LETTERS_COUNT_FOR_BR)+(newText.length>LETTERS_COUNT_FOR_BR?'<br/>':'')+newText.substring(LETTERS_COUNT_FOR_BR+1)+'</span>'}
return newText};drawBall(word){jQuery('.played-balls').prepend('<div class="ball ball_'+word.column.toLowerCase()+'">'+this.splitTextIfLong(word.word)+'</div>')};start(words){let nextBall=function(){let word=this.words.pop();this.textToSpeech.speak(word.column+' '+word.word);this.drawBall(word)}.bind(this);$('#play-now').data('is-started','true');jQuery('#play-now').addClass('paused');this.words=this.createWordsQue(words);nextBall();this.interval=setInterval(function(){if(this.words.length>0){nextBall()}else{this.stop()}}.bind(this),this.defaultTimeout)};pauseAnimation(){jQuery('.played-balls .ball').addClass('paused')}
stop(){$('#play-now').data('is-started','false');jQuery('#play-now').removeClass('paused');jQuery('.played-balls .ball').fadeOut(400,function(){jQuery('.played-balls .ball').remove();this.words=[];clearInterval(this.interval)}.bind(this))}}